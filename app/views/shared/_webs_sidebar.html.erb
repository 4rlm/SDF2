<nav class="container sidebar">

  <% if @wq.present? %>

    <%= search_form_for(@wq, url: search_webs_path, html: {method: :post, class: 'form'}) do |f| %>
      <!-- WEBS CHECK BOX OPTIONS -->

      <% web_opts = get_ransack_web_opts %>
      <% temps = web_opts['temps'] %>
      <% brands = web_opts['brands'] %>
      <% cops = web_opts['cops'] %>
      <% url_stss = web_opts['url_stss'] %>
      <% temp_stss = web_opts['temp_stss'] %>
      <% page_stss = web_opts['page_stss'] %>
      <% cs_stss = web_opts['cs_stss'] %>

      <% act_opts = get_ransack_act_opts %>
      <% states = act_opts['states'] %>
      <% gp_stss = act_opts['gp_stss'] %>

      <!-- SEARCH SECTION - START -->
      <h6 class="text-center sidebar-header"><%= icon('fas', 'external-link-alt', 'Search Websites') %> </h6>
      <ul class="components">
        <!-- SEARCH ACCOUNTS - START -->
        <li>
          <a class="dropdown-toggle" href="#act-criteria" data-toggle="collapse" aria-expanded="false">
            <%= icon('fas', 'building', 'Account Criteria') %>
          </a>
          <ul class="collapse" id="act-criteria">
            <div class="panel sidebar-panel">


              <!-- Search Acts (General-1) -->
            <table class="ransack-table table  text-nowrap">
              <%= f.hidden_field :act_activities_user_id_eq, value: current_user.id  %>

              <tr>
                <td>
                  <%= check_box_tag('q[act_activities_fav_sts_in][]', true ) %>
                  <%= 'Following' %>
                </td>
                <td>
                  <%= check_box_tag('q[act_activities_fav_sts_not_in][]', true ) %>
                  <%= 'None' %>
                </td>
              </tr>

              <tr>
                <td>
                  <%= check_box_tag('q[act_activities_hide_sts_in][]', true ) %>
                  <%= 'Hidden' %>
                </td>
                <td>
                  <%= check_box_tag('q[act_activities_hide_sts_not_in][]', true ) %>
                  <%= 'None' %>
                </td>
              </tr>
            </table>


            <!-- Search Acts (General-Table) -->
            <table class="ransack-table table  text-nowrap">

              <!-- Search Acts (Account Name) -->
              <tr>
                <td class="w25">Account Name</td>
                <td class="w75"><%= f.search_field :acts_act_name_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (Full Address) -->
              <tr>
                <td class="w25">Full Address</td>
                <td class="w75"><%= f.search_field :acts_full_address_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (Street) -->
              <tr>
                <td class="w25">Street</td>
                <td class="w75"><%= f.search_field :acts_street_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (City) -->
              <tr>
                <td class="w25">City</td>
                <td class="w75"><%= f.search_field :acts_city_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (Zip) -->
              <tr>
                <td class="w25">Zip</td>
                <td class="w75"><%= f.search_field :acts_zip_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (Phone) -->
              <tr>
                <td class="w25">Phone</td>
                <td class="w75"><%= f.search_field :acts_phone_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (Lat) -->
              <tr>
                <td class="w25">Lat</td>
                <td class="w75"><%= f.search_field :acts_lat_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (Lon) -->
              <tr>
                <td class="w25">Lon</td>
                <td class="w75"><%= f.search_field :acts_lon_cont_any, class: "form-control ransack-input" %></td>
              </tr>

              <!-- Search Acts (GP ID) -->
              <tr>
                <td class="w25">GP ID</td>
                <td class="w75"><%= f.search_field :acts_gp_id_eq_any, class: "form-control ransack-input" %></td>
              </tr>
            </table>


            <table class="ransack-table table  text-nowrap">
              <% states&.each_with_index do |state, index| %>
                <% if index.even? %>
                  <tr>
                    <!-- LEFT -->
                    <td>
                      <%= check_box_tag('q[acts_state_in][]', state) %>
                      <%= state %>
                    </td>
                  <% else %>
                    <!-- RIGHT -->
                    <td>
                      <%= check_box_tag('q[acts_state_in][]', state) %>
                      <%= state %>
                    </td>
                  </tr>
                <% end %>
              <% end %>
            </table>


            <table class="ransack-table table  text-nowrap">
              <thead>
                <tr>
                  <th colspan="2" class="text-center">GP Status</th>
                </tr>
              </thead>
              <% gp_stss&.each_with_index do |gp_sts, index| %>
                <% if index.even? %>
                  <tr>
                    <!-- LEFT -->
                    <td>
                      <%= check_box_tag('q[acts_gp_sts_in][]', gp_sts) %>
                      <%= gp_sts %>
                    </td>
                  <% else %>
                    <!-- RIGHT -->
                    <td>
                      <%= check_box_tag('q[acts_gp_sts_in][]', gp_sts) %>
                      <%= gp_sts %>
                    </td>
                  </tr>
                <% end %>
              <% end %>
            </table>

              <!-- Search Acts (Dates-3) -->
              <div class="row">
                <table class="ransack-table table  text-nowrap text-center">

                  <!-- gp_date -->
                  <tr>
                    <td>GP Verified</td>
                    <td><%= f.date_field :acts_gp_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :acts_gp_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- adr_changed -->
                  <tr>
                    <td>Address Updated</td>
                    <td><%= f.date_field :acts_adr_changed_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :acts_adr_changed_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- act_changed -->
                  <tr>
                    <td>Acct-Name Updated</td>
                    <td><%= f.date_field :acts_act_changed_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :acts_act_changed_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- ax_date -->
                  <tr>
                    <td>Account InActive</td>
                    <td><%= f.date_field :acts_ax_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :acts_ax_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- updated_at -->
                  <tr>
                    <td>Account Updated</td>
                    <td><%= f.date_field :acts_updated_at_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :acts_updated_at_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- created_at -->
                  <tr>
                    <td>Account Created</td>
                    <td><%= f.date_field :acts_created_at_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :acts_created_at_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                </table>
              </div>
            </div>
          </ul>
        </li>


        <!-- SEARCH WEBS - START -->
        <li>
          <a class="dropdown-toggle" href="#web-criteria" data-toggle="collapse" aria-expanded="false">
            <%= icon('fas', 'external-link-alt', 'Web Criteria') %>
          </a>
          <ul class="collapse" id="web-criteria">
            <div class="panel sidebar-panel">


              <table class="ransack-table table text-nowrap">
                <%= f.hidden_field :web_activities_user_id_eq, value: current_user.id  %>
                <tr>
                  <td class="w50">
                    <%= check_box_tag('q[web_activities_fav_sts_in][]', true ) %>
                    <%= 'Following' %>
                  </td>
                  <td class="w50">
                    <%= check_box_tag('q[web_activities_fav_sts_not_in][]', true ) %>
                    <%= 'None' %>
                  </td>
                </tr>

                <tr>
                  <td class="w50">
                    <%= check_box_tag('q[web_activities_hide_sts_in][]', true ) %>
                    <%= 'Hidden' %>
                  </td>
                  <td class="w50">
                    <%= check_box_tag('q[web_activities_hide_sts_not_in][]', true ) %>
                    <%= 'None' %>
                  </td>
                </tr>

                <tr>
                  <td class="w50">
                    <%= check_box_tag('q[cop_in][]', true) %>
                    <%= 'CoPilot' %>
                  </td>
                  <td class="w50">
                    <%= check_box_tag('q[cop_not_in][]', true) %>
                    <%= 'None' %>
                  </td>
                </tr>
              </table>


              <!-- Search Webs (General-Table) -->
              <table class="ransack-table table text-nowrap">

                <!-- Search Webs (URL) -->
                <tr>
                  <td class="w20">URL</td>
                  <td class="w80"><%= f.search_field :url_cont_any, class: "form-control ransack-input" %></td>
                </tr>
                <!-- Search Webs (FWD URL) -->
                <tr>
                  <td class="w20">FWD URL</td>
                  <td class="w80"><%= f.search_field :fwd_url_cont_any, class: "form-control ransack-input" %></td>

                </tr>
              </table>


              <table class="ransack-table table  text-nowrap">
                <thead>
                  <tr>
                    <th colspan="2" class="text-center">Template</th>
                  </tr>
                </thead>
                <% temps&.each_with_index do |temp_name, index| %>
                  <% if index.even? %>
                    <tr>
                      <!-- LEFT -->
                      <td>
                        <%= check_box_tag('q[temp_name_in][]', temp_name) %>
                        <%= temp_name %>
                      </td>
                    <% else %>
                      <!-- RIGHT -->
                      <td>
                        <%= check_box_tag('q[temp_name_in][]', temp_name) %>
                        <%= temp_name %>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </table>


              <table class="ransack-table table text-nowrap">
                <thead>
                  <tr>
                    <th colspan="2" class="text-center">Brand</th>
                  </tr>
                </thead>
                <% brands&.each_with_index do |brand_name, index| %>
                  <% if index.even? %>
                    <tr>
                      <!-- LEFT -->
                      <td>
                        <%= check_box_tag('q[brands_brand_name_in][]', brand_name) %>
                        <%= brand_name %>
                      </td>
                    <% else %>
                      <!-- RIGHT -->
                      <td>
                        <%= check_box_tag('q[brands_brand_name_in][]', brand_name) %>
                        <%= brand_name %>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </table>


              <table class="ransack-table table  text-nowrap">
                <thead>
                  <tr>
                    <th colspan="2" class="text-center">URL Status</th>
                  </tr>
                </thead>
                <% url_stss&.each_with_index do |url_sts, index| %>
                  <% if index.even? %>
                    <tr>
                      <!-- LEFT -->
                      <td>
                        <%= check_box_tag('q[url_sts_in][]', url_sts) %>
                        <%= url_sts %>
                      </td>
                    <% else %>
                      <!-- RIGHT -->
                      <td>
                        <%= check_box_tag('q[url_sts_in][]', url_sts) %>
                        <%= url_sts %>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </table>


              <table class="ransack-table table  text-nowrap">
                <thead>
                  <tr>
                    <th colspan="2" class="text-center">Template Status</th>
                  </tr>
                </thead>
                <% temp_stss&.each_with_index do |temp_sts, index| %>
                  <% if index.even? %>
                    <tr>
                      <!-- LEFT -->
                      <td>
                        <%= check_box_tag('q[temp_sts_in][]', temp_sts) %>
                        <%= temp_sts %>
                      </td>
                    <% else %>
                      <!-- RIGHT -->
                      <td>
                        <%= check_box_tag('q[temp_sts_in][]', temp_sts) %>
                        <%= temp_sts %>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </table>


              <table class="ransack-table table  text-nowrap">
                <thead>
                  <tr>
                    <th colspan="2" class="text-center">Staff Page Status</th>
                  </tr>
                </thead>
                <% page_stss&.each_with_index do |page_sts, index| %>
                  <% if index.even? %>
                    <tr>
                      <!-- LEFT -->
                      <td>
                        <%= check_box_tag('q[page_sts_in][]', page_sts) %>
                        <%= page_sts %>
                      </td>
                    <% else %>
                      <!-- RIGHT -->
                      <td>
                        <%= check_box_tag('q[page_sts_in][]', page_sts) %>
                        <%= page_sts %>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </table>



              <table class="ransack-table table  text-nowrap">
                <thead>
                  <tr>
                    <th colspan="2" class="text-center">Staff Mined Status</th>
                  </tr>
                </thead>
                <% cs_stss&.each_with_index do |cs_sts, index| %>
                  <% if index.even? %>
                    <tr>
                      <!-- LEFT -->
                      <td>
                        <%= check_box_tag('q[cs_sts_in][]', cs_sts) %>
                        <%= cs_sts %>
                      </td>
                    <% else %>
                      <!-- RIGHT -->
                      <td>
                        <%= check_box_tag('q[cs_sts_in][]', cs_sts) %>
                        <%= cs_sts %>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </table>


              <!-- Search Webs (Dates-Table) -->
              <!-- <p class="text-center"><strong>Dates</strong></p> -->
              <div class="row">
                <table class="ransack-table table  text-nowrap text-center">
                  <thead>
                    <tr>
                      <th>Category</th>
                      <th>Start</th>
                      <th>End</th>
                    </tr>
                  </thead>

                  <!-- URL Verified -->
                  <tr>
                    <td>URL Verified</td>
                    <td><%= f.date_field :url_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :url_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- Template -->
                  <tr>
                    <td>Template Verified</td>
                    <td><%= f.date_field :tmp_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :tmp_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- Staff Page -->
                  <tr>
                    <td>Staff Page Verified</td>
                    <td><%= f.date_field :page_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :page_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- Staff Mined -->
                  <tr>
                    <td>Staff Verified</td>
                    <td><%= f.date_field :cs_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :cs_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- URL Updated -->
                  <tr>
                    <td>URL Updated</td>
                    <td><%= f.date_field :web_changed_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :web_changed_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- URL InActive -->
                  <tr>
                    <td>URL InActive</td>
                    <td><%= f.date_field :wx_date_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :wx_date_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- Web Updated -->
                  <tr>
                    <td>Web Updated</td>
                    <td><%= f.date_field :updated_at_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :updated_at_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>

                  <!-- Web Created -->
                  <tr>
                    <td>Web Created</td>
                    <td><%= f.date_field :created_at_gteq, {class: 'ransack-date-input'} %></td>
                    <td><%= f.date_field :created_at_lteq, {class: 'ransack-date-input'} %></td>
                  </tr>
                </table>
              </div>
            </div>
          </ul>
        </li>
      </ul>



      <!-- SORT SECTION - START -->
      <h6 class="text-center sidebar-header">
        <%= icon('fas', 'sort', 'Sort Options', class: 'fa-pull-right') %>
      </h6>

      <ul class="components">
        <!-- Sort Webs (General-1) -->
        <table class="ransack-table table  text-nowrap">
          <thead>
            <tr>
              <th colspan="2" class="text-center">General</th>
            </tr>
          </thead>
          <tr>
            <td>
              <%= sort_link(@wq, :url) do %>
                <span><%= icon('fas', 'home', 'URL') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :fwd_url) do %>
                <span><%= icon('fas', 'home', 'Redirected URL') %></span>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>
              <%= sort_link(@wq, :brands_brand_name) do %>
                <span><%= icon('fas', 'car', 'Franchise Brand') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :temp_name) do %>
                <span><%= icon('fab', 'firstdraft', 'Template') %></span>
              <% end %>
            </td>
          </tr>
        </table>

        <!-- Sort Webs (Status-2) -->
        <table class="ransack-table table  text-nowrap">
          <thead>
            <tr>
              <th colspan="2" class="text-center">Status</th>
            </tr>
          </thead>
          <tr>
            <td>
              <%= sort_link(@wq, :url_sts) do %>
                <span><%= icon('fas', 'home', 'URL') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :cop) do %>
                <span><%= icon('fas', 'star', 'CoPilot') %></span>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>
              <%= sort_link(@wq, :temp_sts) do %>
                <span><%= icon('fab', 'firstdraft', 'Template') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :page_sts) do %>
                <span><%= icon('fas', 'link', 'Staff Page') %></span>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>
              <%= sort_link(@wq, :cs_sts) do %>
                <span><%= icon('fas', 'users', 'Staff Mined') %></span>
              <% end %>
            </td>

            <td></td>
          </tr>
        </table>

        <!-- Sort Webs (Dates-3) -->
        <table class="ransack-table table  text-nowrap">
          <thead>
            <tr>
              <th colspan="2" class="text-center">Dates</th>
            </tr>
          </thead>
          <tr>
            <td>
              <%= sort_link(@wq, :url_date) do %>
                <span><%= icon('fas', 'home', 'URL Verified') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :web_changed) do %>
                <span><%= icon('fas', 'home', 'URL Updated') %></span>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>
              <%= sort_link(@wq, :wx_date) do %>
                <span><%= icon('fas', 'home', 'URL InActive') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :tmp_date) do %>
                <span><%= icon('fab', 'firstdraft', 'Template Verified') %></span>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>
              <%= sort_link(@wq, :page_date) do %>
                <span><%= icon('fas', 'link', 'Staff Page Verified') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :cs_date) do %>
                <span><%= icon('fas', 'users', 'Staff Mined') %></span>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>
              <%= sort_link(@wq, :created_at) do %>
                <span><%= icon('fas', 'external-link-alt', 'Web Created') %></span>
              <% end %>
            </td>

            <td>
              <%= sort_link(@wq, :updated_at) do %>
                <span><%= icon('fas', 'external-link-alt', 'Web Updated') %></span>
              <% end %>
            </td>
          </tr>
        </table>
      </ul>



      <!-- Save & Name Search Field -->
      <div class="form-group">
        <%= f.text_field :q_name_cont_any, placeholder: "Save search as ..", class: "form-control save-search-as" %>
      </div>


      <div class="row">
        <div class="actions col-md-6"><%= f.submit "Search", class: "btn btn-primary search-btns"%></div>
        <div class="col-md-6"><%= button_tag "Reset", type: :reset, class: "btn btn-danger search-btns" %></div>
      </div>

    <% end %>


    <br>
    <!-- SAVED SEARCHES SECTION - START -->
    <h6 class="text-center sidebar-header">Saved Website Searches</h6>
    <ul class="components">
      <table class="table">
        <% queries = current_user&.queries&.where(mod_name: 'Web')&.order("updated_at DESC") %>
        <% queries&.each_with_index do |query, index| %>
          <tr><td><%= link_to "#{index + 1}. #{query.q_name}", search_webs_path({q: query.params['q']}) %></td></tr>
        <% end %>
      </table>
      <br>
    </ul>
    <br>


  <% end %>

</nav>

<br>
<br>
