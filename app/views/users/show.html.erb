<p id="notice"><%= notice %></p>

<h3>User Profile</h3>

<!-- ## ENSURES ACTIVITIES CREATED FOR USER -->
<% create_all_activities(current_user.id) %>


<div class="row">
  <h6>User Profile</h6>
  <table class="table">
    <thead class="thead-inverse">
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Role</th>
        <th>Registered</th>
        <th>Updated</th>
      </tr>
    </thead>

    <tr>
      <td><%= @user.first_name.capitalize %> <%= @user.last_name.capitalize %></td>
      <td><%= @user.email %></td>
      <td><%= @user.phone %></td>
      <td><%= @user.role.capitalize %></td>
      <td><%= @user.created_at.strftime('%x') %></td>
      <td><%= @user.updated_at.strftime('%x') %></td>
    </tr>
  </table>
</div>

<br>

<div class="panel">
  <h6>Following & Hidden</h6>
  <div class="row">

    <div class="col-md-4">
      <table class="table">
        <thead>
          <tr>
            <th>Acts Followed</th>
            <th>Acts Hidden</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <% act_activities_fav_true = @user.act_activities.where(fav_sts: true) %>
            <% act_activities_hide_true = @user.act_activities.where(hide_sts: true) %>
            <td><%= act_activities_fav_true.count %></td>
            <td><%= act_activities_hide_true.count %></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-md-4">
      <table class="table">
        <thead>
          <tr>
            <th>Conts Followed</th>
            <th>Conts Hidden</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <% cont_activities_fav_true = @user.cont_activities.where(fav_sts: true) %>
            <% cont_activities_hide_true = @user.cont_activities.where(hide_sts: true) %>
            <td><%= cont_activities_fav_true.count %></td>
            <td><%= cont_activities_hide_true.count %></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-md-4">
      <table class="table">
        <thead>
          <tr>
            <th>Webs Followed</th>
            <th>Webs Hidden</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <% web_activities_fav_true = @user.web_activities.where(fav_sts: true) %>
            <% web_activities_hide_true = @user.web_activities.where(hide_sts: true) %>

            <% web_ids = web_activities_fav_true.map(&:web_id) %>
            <% @webs = Web.where(id: [web_ids]) %>

            <!-- <td><%#= link_to web_activities_fav_true.count, master_webs_path %></td> -->
            <% params[:fav_hide_web_ids] = web_ids %>
            <td><%= link_to 'Web Favs', webs_path(params), class: 'btn btn-primary btn-md' %></td>

            <td><%= web_activities_hide_true.count %></td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<br>

<div class="panel">
  <div class="row">

  <div class="col-md-4">
    <h6 class="text-center">Exports</h6>
    <table class="table">
      <thead>
        <tr>
          <th>file_name</th>
          <th>export_date</th>
        </tr>
      </thead>
      <tbody>
        <% exports = @user.exports %>
        <% exports.each do |export| %>
        <tr>
          <td><%= export.file_name %></td>
          <td><%= export.export_date.strftime('%x') %></td>
        </tr>
        <% end %>
      </tbody>
    </table>
  </div>


  <div class="col-md-4">
    <h6 class="text-center">Saved Account Searches</h6>
    <table class="table">
      <thead>
        <tr>
          <th>Search Name</th>
          <th>Created</th>
        </tr>
      </thead>
      <tbody>
        <% web_queries = @user.queries.where(mod_name: 'Web').order("updated_at DESC") %>
        <% web_queries&.each do |web_query| %>
          <tr>
            <td><%= link_to web_query.q_name, search_webs_path({q: web_query.params['q']}) %></td>
            <td><%= web_query.created_at.strftime('%x') %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>


  <div class="col-md-4">
    <h6 class="text-center">Saved Contact Searches</h6>
    <table class="table">
      <thead>
        <tr>
          <th>Search Name</th>
          <th>Created</th>
        </tr>
      </thead>
      <tbody>
        <% cont_queries = @user.queries.where(mod_name: 'Cont').order("updated_at DESC") %>
        <% cont_queries&.each do |cont_query| %>
          <tr>
            <td><%= link_to cont_query.q_name, search_conts_path({q: cont_query.params['q']}) %></td>
            <td><%= cont_query.created_at.strftime('%x') %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  </div>
</div>




<br>
<br>
